# 前言

http基于tcp，tcp是网络层的协议，http是应用层协议。
在tcp建立连接的基础上，才能开始应用http协议

每发起一个http请求，都需要在客户端和服务器建立一个tcp连接管道，用以传输http报文。
由于tcp是有状态的连接，所以服务器需要内存资源来保持一个开启的tcp连接管道。

|-- 服务器 --|
| <tcp>    |
| <tcp>    |
| <tcp>    |
|----------|


# C10K问题

C10K问题（即单机1万个并发连接问题）
初的服务器都是基于进程/线程模型的，新到来一个TCP连接，就需要分配1个进程（或者线程）。而进程又是操作系统最昂贵的资源，一台机器无法创建很多进程。如果是C10K就要创建1万个进程，那么操作系统是无法承受的。如果是采用分布式系统，维持1亿用户在线需要10万台服务器，成本巨大，也只有Facebook，Google，雅虎才有财力购买如此多的服务器。这就是C10K问题的本质。


示例: apache httpd（服务端） + php（执行脚本）
示例2: nodejs（服务端）+ javascript（执行脚本）

请求处理过程演示

[此处有图]

# 进程，线程

进程 -> 线程1
    -> 线程2
    -> 线程3

进程是系统级操作，线程是进程内操作
新建一个进程 远大于 新建 一个线程 大于 本线程内直接处理

在linux 或 mac操作执行ps -ef 可以看到当前正在运行的所有进程

进程因为系统级的，所以它能做的事情非常多，获得系统的资源，状态，跟其它进程通信等。。

## 服务器和端口号

端口是设备与外界通讯交流的出入口

在日常开发中我们常说的端口实际都是tcp协议的端口，用于区分处理tcp协议的程序，如80，8080等

通常情况下，服务器开机启动的会有超级进程用以收取tcp请求

当一个tcp/ip发送过来时，超级进程会接收这个请求并根据端口号，确认这个端口是否有httpd程序申请了监听这个端口号

然后再转发这个这个请求数据到对应的httpd程序进程，这个httpd程序进程通常就是我们说的web服务，如nginx，tomcat，nodejs的net/http模块，apache httpd

[此处有图]




-
